{"is_source_file": true, "format": "JavaScript", "description": "This file implements a module for handling backup snapshot files, including functions to create, list, and read backup snapshots stored as JSON files on disk. It manages filename generation, directory ensuring, and reading/writing JSON snapshots with metadata.", "external_files": ["crypto", "fs/promises", "path"], "external_methods": ["crypto.randomUUID", "crypto.randomBytes", "fs.mkdir", "fs.readdir", "fs.stat", "fs.readFile", "fs.writeFile"], "published": ["writeSnapshot", "listSnapshots", "readSnapshot"], "classes": [], "methods": [{"name": "ensureSnapshotDir()", "description": "Ensures that the snapshot directory exists, creating it if necessary.", "scope": "", "scopeKind": ""}, {"name": "generateSnapshotFilename()", "description": "Generates a stable snapshot filename using UUID, fallback to random bytes if necessary.", "scope": "", "scopeKind": ""}, {"name": "normalizeIdToFilename(idOrFilename)", "description": "Converts input id or filename to a safe filename, preventing path traversal and standardizing extension.", "scope": "", "scopeKind": ""}, {"name": "writeSnapshot(snapshot)", "description": "Serializes a snapshot object to a JSON file on disk, adding metadata such as id and timestamp.", "scope": "", "scopeKind": ""}, {"name": "listSnapshots()", "description": "Reads the snapshot directory and returns a list of snapshot metadata, including size and timestamps.", "scope": "", "scopeKind": ""}, {"name": "readSnapshot(id)", "description": "Reads a snapshot JSON file from disk given an id or filename and returns its contents.", "scope": "", "scopeKind": ""}], "calls": ["fs.mkdir", "generateSnapshotFilename", "fs.writeFile", "fs.readdir", "fs.stat", "fs.readFile"], "search-terms": ["backupsFileStore", "snapshot", "generateSnapshotFilename", "normalizeIdToFilename"], "state": 2, "file_id": 46, "knowledge_revision": 211, "git_revision": "c01804276b6d46f3f2c9051bdc17c11f518cc113", "ctags": [{"_type": "tag", "name": "SNAPSHOT_DIR", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^const SNAPSHOT_DIR = path.join(process.cwd(), 'data', 'backups');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "crypto", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^const crypto = require('crypto');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "ensureSnapshotDir", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^async function ensureSnapshotDir() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "fs", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^const fs = require('fs\\/promises');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "generateSnapshotFilename", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^function generateSnapshotFilename() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "listSnapshots", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^async function listSnapshots() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "normalizeIdToFilename", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^function normalizeIdToFilename(idOrFilename) {$/", "language": "JavaScript", "kind": "function", "signature": "(idOrFilename)"}, {"_type": "tag", "name": "path", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^const path = require('path');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "readSnapshot", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^async function readSnapshot(id) {$/", "language": "JavaScript", "kind": "function", "signature": "(id)"}, {"_type": "tag", "name": "writeSnapshot", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^  writeSnapshot,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "writeSnapshot", "path": "/home/kavia/workspace/code-generation/hello-world-api-7161-7170/api_backend/src/services/backupsFileStore.js", "pattern": "/^async function writeSnapshot(snapshot) {$/", "language": "JavaScript", "kind": "function", "signature": "(snapshot)"}], "hash": "02efefc25543b2c86585ac3d188b8b68", "format-version": 4, "code-base-name": "api_backend", "filename": "api_backend/src/services/backupsFileStore.js", "fields": [{"name": "writeSnapshot,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"211": "c01804276b6d46f3f2c9051bdc17c11f518cc113"}]}